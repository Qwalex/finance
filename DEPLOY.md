# Инструкции по деплою

## Локальный запуск с сохранением данных

Для локального запуска с сохранением данных в томе Docker используйте команду:

```bash
./scripts/local-docker-start.sh
```

Этот скрипт использует конфигурацию `docker-compose.yml.local` с настроенным томом для хранения данных PostgreSQL.

## Деплой на хостинг-платформу

Для деплоя на хостинг-платформу, которая не поддерживает тома Docker:

1. Убедитесь, что основной файл `docker-compose.yml` не содержит определения томов.
2. Запустите стандартную команду деплоя вашего хостинг-провайдера.

**Важно:** При использовании хостинг-платформ без поддержки томов Docker, данные PostgreSQL не будут сохраняться между развертываниями, если контейнеры будут перезапущены или удалены. Для сохранения данных рекомендуется использовать внешнюю базу данных (например, управляемую PostgreSQL).

## Использование внешней базы данных

Для подключения к внешней базе данных:

1. В файле `.env` установите переменную `DATABASE_URL` с корректными учетными данными:

   ```
   DATABASE_URL="postgresql://пользователь:пароль@хост:порт/имя_базы"
   ```

2. В файле `docker-compose.yml` убедитесь, что URL базы данных экранирован правильно:

   ```yaml
   environment:
     - DATABASE_URL=postgresql://пользователь:пароль@хост:порт/имя_базы
   ```

   Если URL содержит специальные символы (например, `@`, `|`, `\`), используйте URL-кодирование для этих символов.

3. Проверьте подключение к базе данных с помощью скрипта:

   ```bash
   ./scripts/check-db-connection.sh
   ```

### Устранение проблем с подключением к базе данных

Если возникают ошибки подключения, проверьте:

1. Доступность базы данных (порт открыт, сервер запущен)
2. Правильность учетных данных
3. Корректное экранирование специальных символов в URL
4. Наличие у пользователя необходимых прав доступа
